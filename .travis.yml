language: csharp
mono: none
dotnet: 2.0.0
dist: trusty
before_install:
  - sudo add-apt-repository ppa:mc3man/trusty-media -y
  - sudo apt-get -qq update
  - sudo apt-get install ffmpeg gstreamer0.10-ffmpeg libav-tools libgdiplus libavcodec-extra  libtheora-dev -y
  - sudo apt-cache policy libav-tools
script:
 - dotnet restore Xabe.FFMpeg.Test/
 - dotnet test Xabe.FFMpeg.Test/
 - dotnet restore Xabe.FFMpeg/
 - dotnet pack Xabe.FFMpeg
 - dotnet build Xabe.FFMpeg/ -c Release
 - if [ $TRAVIS_TAG != "" ]; then
    dotnet pack Xabe.FileLock -c Release -o nuget /p:PackageVersion=$TRAVIS_TAG
    dotnet nuget push Xabe.FileLock/nuget/*.nupkg -k $NUGET_API -s https://www.nuget.org/api/v2/package 
    fi
